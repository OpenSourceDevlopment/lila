!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Draughtsground=e()}}(function(){return function a(i,s,c){function l(r,e){if(!s[r]){if(!i[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(u)return u(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var o=s[r]={exports:{}};i[r][0].call(o.exports,function(e){var t=i[r][1][e];return l(t||e)},o,o.exports,a,i,s,c)}return s[r].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({1:[function(e,t,r){"use strict";var c=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(r,"__esModule",{value:!0});var y=e("./util"),w=e("./board");function o(e,t){var r=e(t);return t.dom.redraw(),r}function k(e,t){return{key:e,pos:y.key2pos(e),piece:t}}function P(e){return"man"===e.role?{role:"ghostman",color:e.color,promoted:e.promoted}:"king"===e.role?{role:"ghostking",color:e.color,promoted:e.promoted}:{role:e.role,color:e.color,promoted:e.promoted}}function M(e){return"white"===e.piece.color&&1===e.pos[1]||"black"===e.piece.color&&10===e.pos[1]}function x(e,t){return e[1]%2==0&&t[1]%2==0?[e[0]-t[0],e[1]-t[1],0,0,-.5]:e[1]%2!=0&&t[1]%2==0?[e[0]-t[0]+.5,e[1]-t[1],0,0,-.5]:e[1]%2==0&&t[1]%2!=0?[e[0]-t[0]-.5,e[1]-t[1],0,0,0]:[e[0]-t[0],e[1]-t[1],0,0,0]}r.anim=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!1),t.animation.enabled?function(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var o=c({},t.pieces),a=e(t),i=function(l,u,d,p){void 0===d&&(d=!1),void 0===p&&(p=!1);var e,f,v,r=[],n=[],t=[],o=[],a={},g={};for(v in l)a[v]=k(v,l[v]);for(var i=0,s=y.allKeys;i<s.length;i++){var c=s[i];e=u.pieces[c],f=a[c],e?f?y.samePiece(e,f.piece)||("white"===f.piece.color?r.push(f):n.push(f),"white"===e.color?t.push(k(c,e)):o.push(k(c,e))):"white"===e.color?t.push(k(c,e)):o.push(k(c,e)):f&&("white"===f.piece.color?r.push(f):n.push(f))}var m={anims:{},fadings:{},captures:{},tempRole:{}},h={anims:{},fadings:{},captures:{},tempRole:{}};1<t.length&&0<r.length&&(t=t.sort(function(e,t){return y.distanceSq(r[0].pos,e.pos)-y.distanceSq(r[0].pos,t.pos)})),1<o.length&&0<n.length&&(o=o.sort(function(e,t){return y.distanceSq(n[0].pos,e.pos)-y.distanceSq(n[0].pos,t.pos)}));var b=r.concat(n);return t.concat(o).forEach(function(t){var r,e;if(r=t,e=b.filter(function(e){return!g[e.key]&&t.piece.color===e.piece.color&&(t.piece.role===e.piece.role||"man"===e.piece.role&&"king"===t.piece.role&&M(t)||"king"===e.piece.role&&"man"===t.piece.role&&M(e))}),(f=e.sort(function(e,t){return y.distanceSq(r.pos,e.pos)-y.distanceSq(r.pos,t.pos)})[0])&&!d){g[f.key]=!0;var n="man"===f.piece.role&&"king"===t.piece.role&&M(t)?"man":void 0;if(!p&&u.lastMove&&2<u.lastMove.length&&u.lastMove[0]===f.key&&u.lastMove[u.lastMove.length-1]===t.key){var o=y.key2pos(u.lastMove[1]),a=void 0;m.anims[t.key]=x(f.pos,o),m.nextPlan=h,n&&(m.tempRole[t.key]=n);var i=new Array,s=w.calcCaptKey(l,f.pos[0],f.pos[1],o[0],o[1]);s&&(i.push(s),l[s]=P(l[s])),m.captures={},b.forEach(function(e){e.piece.color!==t.piece.color&&(-1!==i.indexOf(e.key)?m.captures[e.key]=P(e.piece):m.captures[e.key]=e.piece)});var c={anims:{},fadings:{},captures:{},tempRole:{}};for(v=2;v<u.lastMove.length;v++)a=y.key2pos(u.lastMove[v]),h.anims[t.key]=x(o,a),h.anims[t.key][2]=o[0]-t.pos[0],h.anims[t.key][3]=o[1]-t.pos[1],h.nextPlan=c,n&&(h.tempRole[t.key]=n),(s=w.calcCaptKey(l,o[0],o[1],a[0],a[1]))&&(i.push(s),l[s]=P(l[s])),h.captures={},b.forEach(function(e){e.piece.color!==t.piece.color&&(-1!==i.indexOf(e.key)?h.captures[e.key]=P(e.piece):h.captures[e.key]=e.piece)}),o=a,h=c,c={anims:{},fadings:{},captures:{},tempRole:{}}}else m.anims[t.key]=x(f.pos,t.pos),n&&(m.tempRole[t.key]=n)}}),m}(o,t,r,n);if(u(i.anims)&&u(i.fadings))t.animation.current&&!function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(t.animation.current.lastMove,t.lastMove)&&(t.animation.current=void 0),t.dom.redraw();else{var s=t.animation.current&&t.animation.current.start;t.animation.current={start:l.now(),frequency:(!i.nextPlan||u(i.nextPlan.anims)&&u(i.nextPlan.fadings)?1:2.2)/t.animation.duration,plan:i,lastMove:t.lastMove},s||function t(r,e){var n=r.animation.current;if(void 0!==n){var o,a=1-(e-n.start)*n.frequency;if(a<=0&&(!n.plan.nextPlan||u(n.plan.nextPlan.anims)&&u(n.plan.nextPlan.fadings)?r.animation.current=void 0:(r.animation.current={start:l.now(),frequency:2.2/r.animation.duration,plan:n.plan.nextPlan,lastMove:r.lastMove},n=r.animation.current,a=1-(l.now()-n.start)*n.frequency)),void 0!==r.animation.current){var i=(o=a)<.5?4*o*o*o:(o-1)*(2*o-2)*(2*o-2)+1;for(var s in n.plan.anims){var c=n.plan.anims[s];c[2]=c[0]*i,c[3]=c[1]*i}r.dom.redrawNow(!0),y.raf(function(e){return void 0===e&&(e=l.now()),t(r,e)})}else r.dom.redrawNow()}else r.dom.destroyed||r.dom.redrawNow()}(t,l.now())}return a}(e,t,r,n):o(e,t)},r.render=o;var l=void 0!==window.performance?window.performance:Date;function u(e){for(var t in e)return!1;return!0}r.isObjectEmpty=u},{"./board":3,"./util":16}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("./board"),a=e("./fen"),i=e("./config"),s=e("./anim"),c=e("./drag"),l=e("./explosion");r.start=function(n,e){function r(){o.toggleOrientation(n),e()}return{set:function(t,e){void 0===e&&(e=!1),t.orientation&&t.orientation!==n.orientation&&r(),t.fen?(s.anim(function(e){return i.configure(e,t)},n,!1,e),n.selected&&!n.pieces[n.selected]&&(n.selected=void 0)):s.render(function(e){return i.configure(e,t)},n)},state:n,getFen:function(){return a.write(n.pieces)},toggleOrientation:r,setPieces:function(t){s.anim(function(e){return o.setPieces(e,t)},n)},selectSquare:function(t,r){t?s.anim(function(e){return o.selectSquare(e,t,r)},n):n.selected&&(o.unselect(n),n.dom.redraw())},move:function(t,r){s.anim(function(e){return o.baseMove(e,t,r)},n)},newPiece:function(t,r){s.anim(function(e){return o.baseNewPiece(e,t,r)},n)},playPremove:function(){if(n.premovable.current){var e=n.premovable.current?n.premovable.current[1]:"00";if(s.anim(o.playPremove,n))return void 0!==n.movable.captLen&&1<n.movable.captLen&&o.setSelected(n,e),!0;n.dom.redraw()}return!1},playPredrop:function(e){if(n.predroppable.current){var t=o.playPredrop(n,e);return n.dom.redraw(),t}return!1},cancelPremove:function(){s.render(o.unsetPremove,n)},cancelPredrop:function(){s.render(o.unsetPredrop,n)},cancelMove:function(){s.render(function(e){o.cancelMove(e),c.cancel(e)},n)},stop:function(){s.render(function(e){o.stop(e),c.cancel(e)},n)},explode:function(e){l.default(n,e)},setAutoShapes:function(t){s.render(function(e){return e.drawable.autoShapes=t},n)},setShapes:function(t){s.render(function(e){return e.drawable.shapes=t},n)},getKeyAtDomPos:function(e){return o.getKeyAtDomPos(e,"white"===n.orientation,n.dom.bounds())},redrawAll:e,dragNewPiece:function(e,t,r){c.dragNewPiece(n,e,t,r)},destroy:function(){o.stop(n),n.dom.unbind&&n.dom.unbind(),n.dom.destroyed=!0}}}},{"./anim":1,"./board":3,"./config":4,"./drag":5,"./explosion":9,"./fen":10}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var f=e("./util"),v=e("./premove");function m(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];e&&setTimeout(function(){return e.apply(void 0,t)},1)}function h(e){e.premovable.current&&(e.premovable.current=void 0,m(e.premovable.events.unset))}function b(e){var t=e.predroppable;t.current&&(t.current=void 0,m(t.events.unset))}function g(e,t,r,n,o){var a=n-t,i=o-r,s=0===i?0:0<i?0===a&&2<=Math.abs(i)?2:1:0===a&&2<=Math.abs(i)?-2:-1,c=0===a?0:0===i?0<a?1:-1:r%2==0?a<0?-1:0:0<a?1:0;if(0!==c||0!==s){var l=[t+c,r+s];if(void 0!==l){var u=f.pos2key(l),d=e[u];return void 0!==d&&"ghostman"!==d.role&&"ghostking"!==d.role?u:g(e,t+c,r+s,n,o)}}}function o(e,t,r){if(t===r||!e.pieces[t])return!1;var n=f.key2pos(t),o=f.key2pos(r),a=void 0!==e.movable.captLen&&0<e.movable.captLen,i=a?g(e.pieces,n[0],n[1],o[0],o[1]):void 0,s=a&&i?e.pieces[i]:void 0,c=e.pieces[t];if(r==e.selected&&P(e),m(e.events.move,t,r,s),!e.movable.free&&(void 0===e.movable.captLen||e.movable.captLen<=1)&&"man"===c.role&&("white"===c.color&&1===o[1]||"black"===c.color&&10===o[1])?e.pieces[r]={role:"king",color:c.color}:e.pieces[r]=e.pieces[t],delete e.pieces[t],a&&i){var l=e.pieces[i].color,u=e.pieces[i].role;if(delete e.pieces[i],void 0!==e.movable.captLen&&1<e.movable.captLen)"man"===u?e.pieces[i]={role:"ghostman",color:l}:"king"===u&&(e.pieces[i]={role:"ghostking",color:l});else for(var d=0;d<f.allKeys.length;d++){var p=e.pieces[f.allKeys[d]];void 0===p||"ghostking"!=p.role&&"ghostman"!=p.role||delete e.pieces[f.allKeys[d]]}}return e.lastMove&&0<e.lastMove.length&&a&&e.lastMove[e.lastMove.length-1]==t?e.lastMove.push(r):e.lastMove=[t,r],m(e.events.change),s||!0}function y(e,t,r,n){if(e.pieces[r]){if(!n)return!1;delete e.pieces[r]}return m(e.events.dropNewPiece,t,r),e.pieces[r]=t,e.lastMove=[r],m(e.events.change),e.movable.dests=void 0,e.turnColor=f.opposite(e.turnColor),!0}function w(e,t,r){var n=o(e,t,r);return n&&(e.movable.dests=void 0,(!e.movable.captLen||e.movable.captLen<=1)&&(e.turnColor=f.opposite(e.turnColor)),e.animation.current=void 0),n}function n(e,t,r){if(x(e,t,r)){var n=w(e,t,r);if(n){var o=e.hold.stop();P(e);var a={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:o};return!0!==n&&(a.captured=n),m(e.movable.events.after,t,r,a),!0}}else u=e,(d=t)!==(p=r)&&O(u,d)&&f.containsX(v.default(u.pieces,d,u.premovable.variant),p)?(s=t,c=r,l={ctrlKey:(i=e).stats.ctrlKey},b(i),i.premovable.current=[s,c],m(i.premovable.events.set,s,c,l),P(e)):M(e,r)||O(e,r)?(k(e,r),e.hold.start()):P(e);var i,s,c,l,u,d,p;return!1}function k(e,t){e.selected=t,O(e,t)?e.premovable.dests=v.default(e.pieces,t,e.premovable.variant):e.premovable.dests=void 0}function P(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function M(e,t){var r=e.pieces[t];return r&&("both"===e.movable.color||e.movable.color===r.color&&e.turnColor===r.color)}function x(e,t,r){return t!==r&&M(e,t)&&(e.movable.free||!!e.movable.dests&&f.containsX(e.movable.dests[t],r))}function O(e,t){var r=e.pieces[t];return r&&e.premovable.enabled&&e.movable.color===r.color&&e.turnColor!==r.color}function a(e){h(e),b(e),P(e)}r.callUserFunction=m,r.toggleOrientation=function(e){e.orientation=f.opposite(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0},r.reset=function(e){e.lastMove=void 0,P(e),h(e),b(e)},r.setPieces=function(e,t){for(var r in t){var n=t[r];n?e.pieces[r]=n:delete e.pieces[r]}},r.unsetPremove=h,r.unsetPredrop=b,r.calcCaptKey=g,r.baseMove=o,r.baseNewPiece=y,r.userMove=n,r.dropNewPiece=function(e,t,r,n){if(f=t,v=r,(g=(p=e).pieces[f])&&v&&(f===v||!p.pieces[v])&&("both"===p.movable.color||p.movable.color===g.color&&p.turnColor===g.color)||n){var o=e.pieces[t];delete e.pieces[t],y(e,o,r,n),m(e.movable.events.afterNewPiece,o.role,r,{predrop:!1})}else l=t,u=r,(d=(c=e).pieces[l])&&u&&(!c.pieces[u]||c.pieces[u].color!==c.movable.color)&&c.predroppable.enabled&&c.movable.color===d.color&&c.turnColor!==d.color?(i=(a=e).pieces[t].role,s=r,h(a),a.predroppable.current={role:i,key:s},m(a.predroppable.events.set,i,s)):(h(e),b(e));var a,i,s,c,l,u,d,p,f,v,g;delete e.pieces[t],P(e)},r.selectSquare=function(e,t,r){e.selected?e.selected!==t||e.draggable.enabled?(e.selectable.enabled||r)&&e.selected!==t?n(e,e.selected,t)&&(e.stats.dragged=!1,void 0!==e.movable.captLen&&1<e.movable.captLen&&k(e,t)):e.hold.start():(P(e),e.hold.cancel()):(M(e,t)||O(e,t))&&(k(e,t),e.hold.start()),m(e.events.select,t)},r.setSelected=k,r.unselect=P,r.canMove=x,r.isDraggable=function(e,t){var r=e.pieces[t];return r&&e.draggable.enabled&&("both"===e.movable.color||e.movable.color===r.color&&(e.turnColor===r.color||e.premovable.enabled))},r.playPremove=function(e){var t=e.premovable.current;if(!t)return!1;var r=t[0],n=t[1],o=!1;if(x(e,r,n)){var a=w(e,r,n);if(a){var i={premove:!0};!0!==a&&(i.captured=a),m(e.movable.events.after,r,n,i),o=!0}}return h(e),o},r.playPredrop=function(e,t){var r=e.predroppable.current,n=!1;return!!r&&(t(r)&&y(e,{role:r.role,color:e.movable.color},r.key)&&(m(e.movable.events.afterNewPiece,r.role,r.key,{predrop:!0}),n=!0),b(e),n)},r.cancelMove=a,r.stop=function(e){e.movable.color=e.movable.dests=e.animation.current=void 0,a(e)},r.getKeyAtDomPos=function(e,t,r){var n=Math.ceil((e[1]-r.top)/r.height*10);t||(n=11-n);var o=Math.ceil((e[0]-r.left)/r.width*10);if(t||(o=11-o),n%2!=0){if(o%2!=0)return;o/=2}else{if(o%2==0)return;o=(o+1)/2}return 0<o&&o<6&&0<n&&n<11?f.pos2key([o,n]):void 0}},{"./premove":12,"./util":16}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./board"),o=e("./fen");function a(e){return"object"==typeof e}r.configure=function(e,t){t.movable&&t.movable.dests&&(e.movable.dests=void 0),function e(t,r){for(var n in r)a(t[n])&&a(r[n])?e(t[n],r[n]):t[n]=r[n]}(e,t),t.fen&&(e.pieces=o.read(t.fen),e.drawable.shapes=[]),t.hasOwnProperty("lastMove")&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),void 0!==t.captureLength&&(e.movable.captLen=t.captureLength),e.selected&&n.setSelected(e,e.selected),(!e.animation.duration||e.animation.duration<100)&&(e.animation.enabled=!1)}},{"./board":3,"./fen":10}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var v=e("./board"),g=e("./util"),m=e("./draw"),h=e("./anim"),b=e("./render");function y(i){g.raf(function(){var e=i.draggable.current;if(e){i.animation.current&&i.animation.current.plan.anims[e.orig]&&(i.animation.current=void 0);var t=i.pieces[e.orig];if(t&&g.samePiece(t,e.piece)){if(!e.started&&g.distanceSq(e.epos,e.rel)>=Math.pow(i.draggable.distance,2)&&(e.started=!0),e.started){if("function"==typeof e.element){var r=e.element();if(!r)return;e.element=r,e.element.cgDragging=!0,e.element.classList.add("dragging")}var n="white"===i.orientation,o=i.dom.bounds();e.pos=[e.epos[0]-e.rel[0],e.epos[1]-e.rel[1]];var a=g.posToTranslateAbs(o)(e.origPos,n,0);a[0]+=e.pos[0]+e.dec[0],a[1]+=e.pos[1]+e.dec[1],g.translateAbs(e.element,a)}}else s(i);y(i)}})}function s(e){var t=e.draggable.current;t&&(t.newPiece&&delete e.pieces[t.orig],e.draggable.current=void 0,v.unselect(e),a(e),e.dom.redraw())}function a(e){var t=e.dom.elements;t.ghost&&g.translateAway(t.ghost)}function w(e,t,r){var n=g.key2pos(e);return t||(n[0]=6-n[0],n[1]=11-n[1]),{left:r.left+r.width*(2*(n[0]-1)+(n[1]%2!=0?1:0))/10,top:r.top+r.height*(n[1]-1)/10,width:r.width/10,height:r.height/10}}function k(e,t){for(var r=e.dom.elements.board.firstChild;r;){if(r.cgKey===t&&"PIECE"===r.tagName)return r;r=r.nextSibling}}r.start=function(e,t){if(!(void 0!==t.button&&0!==t.button||t.touches&&1<t.touches.length)){t.preventDefault();var r="white"===e.orientation,n=e.dom.bounds(),o=g.eventPosition(t),a=v.getKeyAtDomPos(o,r,n);if(a){var i=e.pieces[a],s=e.selected;s||!e.drawable.enabled||!e.drawable.eraseOnClick&&i&&i.color===e.turnColor||m.clear(e);var c=!!e.premovable.current,l=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&v.canMove(e,e.selected,a)?h.anim(function(e){return v.selectSquare(e,a)},e):v.selectSquare(e,a);var u=e.selected===a,d=k(e,a);if(i&&d&&u&&v.isDraggable(e,a)){var p=w(a,r,n);e.draggable.current={orig:a,origPos:g.key2pos(a),piece:i,rel:o,epos:o,pos:[0,0],dec:e.draggable.centerPiece?[o[0]-(p.left+p.width/2),o[1]-(p.top+p.height/2)]:[0,0],started:e.draggable.autoDistance&&e.stats.dragged,element:d,previouslySelected:s,originTarget:t.target},d.cgDragging=!0,d.classList.add("dragging");var f=e.dom.elements.ghost;f&&(f.className="ghost "+b.pieceNameOf(i),g.translateAbs(f,g.posToTranslateAbs(n)(g.key2pos(a),r,0))),y(e)}else c&&v.unsetPremove(e),l&&v.unsetPredrop(e);e.dom.redraw()}}},r.dragNewPiece=function(e,t,r,n){var o="00";e.pieces[o]=t,e.dom.redraw();var a=g.eventPosition(r),i="white"===e.orientation,s=e.dom.bounds(),c=w(o,i,s),l=[(i?-1:10)*c.width+s.left,(i?0:9)*c.height+s.top];e.draggable.current={orig:o,origPos:g.key2pos(o),piece:t,rel:l,epos:a,pos:[a[0]-l[0],a[1]-l[1]],dec:[-c.width/2,-c.height/2],started:!0,element:function(){return k(e,o)},originTarget:r.target,newPiece:!0,force:n||!1},y(e)},r.move=function(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.epos=g.eventPosition(t))},r.end=function(e,t){var r=e.draggable.current;if(r)if("touchend"!==t.type||!r||r.originTarget===t.target||r.newPiece){v.unsetPremove(e),v.unsetPredrop(e);var n=g.eventPosition(t)||r.epos,o=v.getKeyAtDomPos(n,"white"===e.orientation,e.dom.bounds());o&&r.started?r.newPiece?v.dropNewPiece(e,r.orig,o,r.force):(e.stats.ctrlKey=t.ctrlKey,h.anim(function(e){return v.userMove(e,r.orig,o)},e,!0)&&(e.stats.dragged=!0,void 0!==e.movable.captLen&&1<e.movable.captLen&&v.setSelected(e,o))):r.newPiece?delete e.pieces[r.orig]:e.draggable.deleteOnDropOff&&(delete e.pieces[r.orig],v.callUserFunction(e.events.change)),(!r||r.orig!==r.previouslySelected||r.orig!==o&&o)&&e.selectable.enabled||v.unselect(e),a(e),e.draggable.current=void 0,e.dom.redraw()}else e.draggable.current=void 0},r.cancel=s},{"./anim":1,"./board":3,"./draw":7,"./render":13,"./util":16}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./api"),o=e("./config"),a=e("./state"),u=e("./wrap"),d=e("./events"),p=e("./render"),f=e("./svg"),v=e("./util");r.Draughtsground=function(s,e){var c=a.defaults();function l(){var e=c.dom&&c.dom.unbind;s.classList.add("cg-board-wrap");var t,r,n=v.memo(function(){return s.getBoundingClientRect()}),o=c.viewOnly&&!c.drawable.visible,a=u.default(s,c,o?void 0:n()),i=function(e){p.default(c),!e&&a.svg&&f.renderSvg(c,a.svg)};c.dom={elements:a,bounds:n,redraw:(t=i,r=!1,function(){r||(r=!0,v.raf(function(){t(),r=!1}))}),redrawNow:i,unbind:e,relative:o},c.drawable.prevSvgHash="",i(!1),d.bindBoard(c),e||(c.dom.unbind=d.bindDocument(c,l))}return o.configure(c,e||{}),l(),n.start(c,l)}},{"./api":2,"./config":4,"./events":8,"./render":13,"./state":14,"./svg":15,"./util":16,"./wrap":17}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=e("./board"),c=e("./util"),l=["green","red","blue","yellow"];function u(r){c.raf(function(){var e=r.drawable.current;if(e){var t=s.getKeyAtDomPos(e.pos,"white"===r.orientation,r.dom.bounds());t!==e.mouseSq&&(t?(e.mouseSq=t,e.prev=void 0,e.dest=t!==e.orig?t:void 0):(e.prev=e.mouseSq,e.mouseSq=void 0),r.dom.redrawNow()),u(r)}})}function d(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function p(e){e.onChange&&e.onChange(e.shapes)}r.start=function(e,t){if(!(t.touches&&1<t.touches.length)){t.stopPropagation(),t.preventDefault(),t.ctrlKey?s.unselect(e):s.cancelMove(e);var r,n,o,a=c.eventPosition(t),i=s.getKeyAtDomPos(a,"white"===e.orientation,e.dom.bounds());i&&(e.drawable.current={orig:i,pos:a,brush:(r=t,n=r.shiftKey&&c.isRightButton(r)?1:0,o=r.altKey?2:0,l[n+o])},u(e))}},r.processDraw=u,r.move=function(e,t){e.drawable.current&&(e.drawable.current.pos=c.eventPosition(t))},r.end=function(e){var t=e.drawable.current;t&&(t.mouseSq&&(r=e.drawable,n=t,a=function(e){return e.orig===n.orig&&e.dest===n.dest},i=r.shapes.filter(a)[0],i&&(r.shapes=r.shapes.filter((o=a,function(e){return!o(e)}))),i&&i.brush===n.brush||r.shapes.push(n),p(r)),d(e));var r,n,o,a,i},r.cancel=d,r.clear=function(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),p(e.drawable))}},{"./board":3,"./util":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./drag"),s=e("./draw"),c=e("./util");function l(e,t,r,n){return e.addEventListener(t,r,n),function(){return e.removeEventListener(t,r)}}function u(t,r,n){return function(e){e.shiftKey||c.isRightButton(e)?t.drawable.enabled&&n(t,e):t.viewOnly||r(t,e)}}r.bindBoard=function(e){if(!e.viewOnly){var t,r=e.dom.elements.board,n=(t=e,function(e){t.draggable.current?i.cancel(t):t.drawable.current?s.cancel(t):e.shiftKey||c.isRightButton(e)?t.drawable.enabled&&s.start(t,e):t.viewOnly||i.start(t,e)});r.addEventListener("touchstart",n),r.addEventListener("mousedown",n),(e.disableContextMenu||e.drawable.enabled)&&r.addEventListener("contextmenu",function(e){return e.preventDefault()})}},r.bindDocument=function(e,t){var r=[];!e.dom.relative&&e.resizable&&r.push(l(document.body,"draughtsground.resize",function(){e.dom.bounds.clear(),c.raf(t)}));if(!e.viewOnly){var n=u(e,i.move,s.move),o=u(e,i.end,s.end);["touchmove","mousemove"].forEach(function(e){return r.push(l(document,e,n))}),["touchend","mouseup"].forEach(function(e){return r.push(l(document,e,o))});var a=function(){return e.dom.bounds.clear()};r.push(l(window,"scroll",a,{passive:!0})),r.push(l(window,"resize",a,{passive:!0}))}return function(){return r.forEach(function(e){return e()})}}},{"./drag":5,"./draw":7,"./util":16}],9:[function(e,t,r){"use strict";function n(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(function(){n(e,2),setTimeout(function(){return n(e,void 0)},120)},120)}},{}],10:[function(e,t,l){"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.initial="W31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50:B1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20",l.read=function(e){"start"===e&&(e=l.initial);for(var t={},r=e.split(":"),n=0;n<r.length;n++){var o="";if("W"===r[n].slice(0,1)?o="white":"B"===r[n].slice(0,1)&&(o="black"),0!==o.length&&1<r[n].length)for(var a=r[n].slice(1).split(","),i=0;i<a.length;i++){var s=void 0,c=void 0;"K"===a[i].slice(0,1)?(c="king",s=a[i].slice(1)):"G"===a[i].slice(0,1)?(c="ghostman",s=a[i].slice(1)):"P"===a[i].slice(0,1)?(c="ghostking",s=a[i].slice(1)):(c="man",s=a[i]),1==s.length&&(s="0"+s),t[s]={role:c,color:o}}}return t},l.write=function(e){for(var t="W",r="B",n=1;n<=50;n++){var o=e[n<10?"0"+n.toString():n.toString()];o&&("white"===o.color?(1<t.length&&(t+=","),"king"===o.role?t+="K":"ghostman"===o.role?t+="G":"ghostking"===o.role&&(t+="P"),t+=n.toString()):(1<r.length&&(r+=","),"king"===o.role?r+="K":"ghostman"===o.role?r+="G":"ghostking"===o.role&&(r+="P"),r+=n.toString()))}return t+":"+r},l.countGhosts=function(e){"start"===e&&(e=l.initial);for(var t=0,r=e.split(":"),n=0;n<r.length;n++){var o="";if("W"===r[n].slice(0,1)?o="white":"B"===r[n].slice(0,1)&&(o="black"),0!==o.length&&1<r[n].length)for(var a=r[n].slice(1).split(","),i=0;i<a.length;i++)"G"!==a[i].slice(0,1)&&"P"!==a[i].slice(0,1)||t++}return t}},{}],11:[function(e,t,r){t.exports=e("./draughtsground").Draughtsground},{"./draughtsground":6}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d=[[-1,-1,-1],[6,7,11],[7,8,12],[8,9,13],[9,10,14],[10,-1,15],[-1,11,16],[11,12,17],[12,13,18],[13,14,19],[14,15,20],[16,17,21],[17,18,22],[18,19,23],[19,20,24],[20,-1,25],[-1,21,26],[21,22,27],[22,23,28],[23,24,29],[24,25,30],[26,27,31],[27,28,32],[28,29,33],[29,30,34],[30,-1,35],[-1,31,36],[31,32,37],[32,33,38],[33,34,39],[34,35,40],[36,37,41],[37,38,42],[38,39,43],[39,40,44],[40,-1,45],[-1,41,46],[41,42,47],[42,43,48],[43,44,49],[44,45,50],[46,47,-1],[47,48,-1],[48,49,-1],[49,50,-1],[50,-1,-1],[-1,-1,-1],[-1,-1,-1],[-1,-1,-1],[-1,-1,-1],[-1,-1,-1]],p=[[-1,-1,-1],[-1,-1,-1],[-1,-1,-1],[-1,-1,-1],[-1,-1,-1],[-1,-1,-1],[-1,1,-1],[1,2,-1],[2,3,-1],[3,4,-1],[4,5,-1],[6,7,1],[7,8,2],[8,9,3],[9,10,4],[10,-1,5],[-1,11,6],[11,12,7],[12,13,8],[13,14,9],[14,15,10],[16,17,11],[17,18,12],[18,19,13],[19,20,14],[20,-1,15],[-1,21,16],[21,22,17],[22,23,18],[23,24,19],[24,25,20],[26,27,21],[27,28,22],[28,29,23],[29,30,24],[30,-1,25],[-1,31,26],[31,32,27],[32,33,28],[33,34,29],[34,35,30],[36,37,31],[37,38,32],[38,39,33],[39,40,34],[40,-1,35],[-1,41,36],[41,42,37],[42,43,38],[43,44,39],[44,45,40]],f=[[-1,-1],[-1,2],[1,3],[2,4],[3,5],[4,-1],[-1,7],[6,8],[7,9],[8,10],[9,-1],[-1,12],[11,13],[12,14],[13,15],[14,-1],[-1,17],[16,18],[17,19],[18,20],[19,-1],[-1,22],[21,23],[22,24],[23,25],[24,-1],[-1,27],[26,28],[27,29],[28,30],[29,-1],[-1,32],[31,33],[32,34],[33,35],[34,-1],[-1,37],[36,38],[37,39],[38,40],[39,-1],[-1,42],[41,43],[42,44],[43,45],[44,-1],[-1,47],[46,48],[47,49],[48,50],[49,-1]];function v(e){return e<10?"0"+e.toString():e.toString()}r.default=function(e,t,r){var n=e[t],o=Number(t);if(void 0===n||isNaN(o))return new Array;var a=r&&"frisian"===r,i=new Array;switch(n.role){case"man":for(var s=0;s<(a?3:2);s++)-1!=(l=p[o][s])&&("white"===n.color&&s<2&&i.push(v(l)),void 0!==(c=e[v(l)])&&c.color===n.color||-1!==(l=p[l][s])&&i.push(v(l)));for(s=0;s<(a?3:2);s++)-1!=(l=d[o][s])&&("black"===n.color&&s<2&&i.push(v(l)),void 0!==(c=e[v(l)])&&c.color===n.color||-1!==(l=d[l][s])&&i.push(v(l)));if(a)for(s=0;s<2;s++){var c;-1!=(l=f[o][s])&&(void 0!==(c=e[v(l)])&&c.color===n.color||-1!==(l=f[l][s])&&i.push(v(l)))}break;case"king":for(s=0;s<(a?3:2);s++)for(var l=p[o][s],u=0;-1!=l;)(s<2||0<u)&&i.push(v(l)),l=p[l][s],u++;for(s=0;s<(a?3:2);s++)for(l=d[o][s],u=0;-1!=l;)(s<2||0<u)&&i.push(v(l)),l=d[l][s],u++;if(a)for(s=0;s<2;s++)for(l=f[o][s],u=0;-1!=l;)0<u&&i.push(v(l)),l=f[l][s],u++}return i}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var F=e("./util"),G=e("./util"),z=e("./anim");function H(e,t){for(var r in t)e.dom.elements.board.removeChild(t[r])}function U(e,t){var r=2+8*(e[1]-1)+(8-e[0]);return t&&(r=67-r),r+""}function X(e){return"ghostman"===e.role?e.color+" man ghost":"ghostking"===e.role?e.color+" king ghost":e.color+" "+e.role}function Z(e,t,r){e[t]?e[t]+=" "+r:e[t]=r}r.default=function(e){var t,r,n,o,a,i,s,c,l,u,d,p,f,v="white"===e.orientation,g=e.dom.relative?G.posToTranslateRel:G.posToTranslateAbs(e.dom.bounds()),m=e.dom.relative?G.translateRel:G.translateAbs,h=e.dom.elements.board,b=e.pieces,y=e.animation.current,w=y?y.plan.anims:{},k=y?y.plan.fadings:{},P=y?y.plan.captures:{},M=y?y.plan.tempRole:{},x=e.draggable.current,O=function(e){var t,r,n={};if(e.lastMove&&e.highlight.lastMove)for(t in e.lastMove)e.lastMove[t]!==e.selected&&Z(n,e.lastMove[t],"last-move");if(e.selected&&(Z(n,e.selected,"selected"),e.movable.showDests)){var o=e.movable.dests&&e.movable.dests[e.selected];if(o)for(t in o)r=o[t],Z(n,r,"move-dest"+(e.pieces[r]?" oc":""));var a=e.premovable.dests;if(a)for(t in a)r=a[t],Z(n,r,"premove-dest"+(e.pieces[r]?" oc":""))}var i=e.premovable.current;if(i)for(t in i)Z(n,i[t],"current-premove");else e.predroppable.current&&Z(n,e.predroppable.current.key,"current-premove");var s=e.exploding;if(s)for(t in s.keys)Z(n,s.keys[t],"exploding"+s.stage);return n}(e),S={},C={},L={},K={},N=Object.keys(b);for(n=h.firstChild;n;){if(t=n.cgKey,"PIECE"===n.tagName)if(o=b[t],i=w[t],s=k[t],c=P[t],l=M[t],a=n.cgPiece,!n.cgDragging||x&&x.orig===t||(n.classList.remove("dragging"),m(n,g(F.key2pos(t),v,0)),n.cgDragging=!1),!s&&n.cgFading&&(n.cgFading=!1,n.classList.remove("fading")),n.classList.contains("temporary")&&c){var E=X(c)+" temporary";a!==E&&(n.className=E),S[t]=!0}else o?(i&&n.cgAnimating&&a===X(o)?((T=F.key2pos(t))[0]+=i[2],T[1]+=i[3],!(y&&y.plan.nextPlan&&y.plan.nextPlan.anims[t])||z.isObjectEmpty(y.plan.nextPlan.anims[t])&&z.isObjectEmpty(y.plan.nextPlan.fadings[t])||(T[0]+=y.plan.nextPlan.anims[t][2],T[1]+=y.plan.nextPlan.anims[t][3]),n.classList.add("anim"),l?(n.className=n.className.replace(o.role,l),n.classList.add("temprole")):n.classList.contains("temprole")&&(n.classList.remove("temprole"),"king"===o.role?n.className=n.className.replace("man","king"):"man"===o.role&&(n.className=n.className.replace("king","man"))),m(n,g(T,v,i[4]))):n.cgAnimating&&(n.cgAnimating=!1,n.classList.remove("anim"),n.classList.contains("temprole")&&(n.classList.remove("temprole"),"king"===o.role?n.className=n.className.replace("man","king"):"man"===o.role&&(n.className=n.className.replace("king","man"))),m(n,g(F.key2pos(t),v,0)),e.addPieceZIndex&&(n.style.zIndex=U(F.key2pos(t),v))),a!==X(o)||s&&n.cgFading?s&&a===X(s)?(n.classList.add("fading"),n.cgFading=!0):L[a]?L[a].push(n):L[a]=[n]:S[t]=!0):L[a]?L[a].push(n):L[a]=[n];else if("SQUARE"===n.tagName){var A=n.className;O[t]===A?C[t]=!0:K[A]?K[A].push(n):K[A]=[n]}n=n.nextSibling}for(var _ in O)if(!C[_]){f=(p=K[O[_]])&&p.pop();var D=g(F.key2pos(_),v,0);if(f)f.cgKey=_,m(f,D);else{var q=F.createEl("square",O[_]);q.cgKey=_,m(q,D),h.insertBefore(q,h.firstChild)}}for(var j in N)if(r=b[t=N[j]],i=w[t],c=P[t],!S[t]&&!c)if(d=(u=L[X(r)])&&u.pop()){d.cgKey=t,d.cgFading&&(d.classList.remove("fading"),d.cgFading=!1);var T=F.key2pos(t);e.addPieceZIndex&&(d.style.zIndex=U(T,v));var R=void 0;i?(d.cgAnimating=!0,d.classList.add("anim"),T[0]+=i[2],T[1]+=i[3],R=i[4]):R=0,m(d,g(T,v,R))}else{var W=X(r),B=F.createEl("piece",W);T=F.key2pos(t),B.cgPiece=W,B.cgKey=t,R=void 0,i?(B.cgAnimating=!0,T[0]+=i[2],T[1]+=i[3],R=i[4]):R=0,m(B,g(T,v,R)),e.addPieceZIndex&&(B.style.zIndex=U(T,v)),h.appendChild(B)}for(var I in P)(c=P[t=I])&&!S[t]&&(W=X(c)+" temporary",B=F.createEl("piece",W),T=F.key2pos(t),B.cgPiece=W,B.cgKey=t,m(B,g(T,v,0)),e.addPieceZIndex&&(B.style.zIndex=U(T,v)),h.appendChild(B));for(var I in L)H(e,L[I]);for(var I in K)H(e,K[I])},r.pieceNameOf=X},{"./anim":1,"./util":16}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./fen"),o=e("./util");r.defaults=function(){return{pieces:n.read(n.initial),orientation:"white",turnColor:"white",coordinates:!0,viewOnly:!1,disableContextMenu:!1,resizable:!0,addPieceZIndex:!1,pieceKey:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,centerPiece:!0,showGhost:!0,deleteOnDropOff:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}},pieces:{baseUrl:"https://lidraughts.org/assets/piece/wide/"},prevSvgHash:""},hold:o.timer()}}},{"./fen":10,"./util":16}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var z,H=e("./util");function U(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function l(e,t,r){var n,o,a=e.orig,i=e.dest,s=e.brush,c=e.piece,l=e.modifiers;return[r,a,i,s,i&&1<t[i],c&&(o=c,[o.color,o.role,o.scale].filter(function(e){return e}).join("")),l&&(n=l,""+(n.lineWidth||""))].filter(function(e){return e}).join("")}function u(e){var t=X(U("marker"),{id:"arrowhead-"+e.key,orient:"auto",markerWidth:4,markerHeight:8,refX:2.05,refY:2.01});return t.appendChild(X(U("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function X(e,t){for(var r in t)e.setAttribute(r,t[r]);return e}function Z(e,t){return"white"===t?e:[6-e[0],11-e[1]]}function Y(e,t){var r={color:e.color,opacity:Math.round(10*e.opacity)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth)};return r.key=[e.key,t.lineWidth].filter(function(e){return e}).join(""),r}function Q(e,t){return(e.opacity||1)*(t?.9:1)}function V(e,t){return[(2*e[0]-(e[1]%2!=0?.5:1.5))*t.width/10,(e[1]-.5)*t.height/10]}r.createElement=U,r.renderSvg=function(e,t){var r=e.drawable,n=r.current,o={},a=n&&(n.mouseSq||n.prev)?n:void 0;r.shapes.concat(r.autoShapes).concat(a?[a]:[]).forEach(function(e){e.dest&&(o[e.dest]=(o[e.dest]||0)+1)});var i=r.shapes.concat(r.autoShapes).map(function(e){return{shape:e,current:!1,hash:l(e,o,!1)}});a&&i.push({shape:a,current:!0,hash:l(a,o,!0)});var s=i.map(function(e){return e.hash}).join("");if(s!==e.drawable.prevSvgHash){e.drawable.prevSvgHash=s;var c=t.firstChild;!function(t,e,r){var n,o={};e.forEach(function(e){e.shape.dest&&(n=t.brushes[e.shape.brush],e.shape.modifiers&&(n=Y(n,e.shape.modifiers)),o[n.key]=n)});for(var a={},i=r.firstChild;i;)a[i.getAttribute("cgKey")]=!0,i=i.nextSibling;for(var s in o)a[s]||r.appendChild(u(o[s]))}(r,i,c),function(t,e,r,n,o,a){void 0===z&&(z=H.computeIsTrident());var i=t.dom.bounds(),s={},c=[];e.forEach(function(e){s[e.hash]=!1});for(var l,u=a.nextSibling;u;)l=u.getAttribute("cgHash"),s.hasOwnProperty(l)?s[l]=!0:c.push(u),u=u.nextSibling;c.forEach(function(e){return o.removeChild(e)}),e.forEach(function(e){s[e.hash]||o.appendChild(function(e,t,r,n,o){var a,i,s,c,l,u,d,p,f,v,g,m,h,b,y,w,k,P,M,x,O,S,C,L,K,N,E,A,_,D,q,j,T,R,W=t.shape,B=t.current,I=t.hash;if(W.piece)A=e.drawable.pieces.baseUrl,_=Z(H.key2pos(W.orig),e.orientation),D=W.piece,j=V(_,q=o),T=q.width/10*(D.scale||1),R=D.color[0]+("man"===D.role?"Q":D.role[0]).toUpperCase(),a=X(U("image"),{className:D.role+" "+D.color,x:j[0]-T/2,y:j[1]-T/2,width:T,height:T,href:A+R+".svg"});else{var F=Z(H.key2pos(W.orig),e.orientation);if(W.orig&&W.dest){var G=r[W.brush];W.modifiers&&(G=Y(G,W.modifiers)),f=G,v=F,g=Z(H.key2pos(W.dest),e.orientation),m=B,h=1<n[W.dest],C=b=o,L=h&&!m,y=z?0:(L?20:10)/512*C.width,w=V(v,b),k=V(g,b),P=k[0]-w[0],M=k[1]-w[1],x=Math.atan2(M,P),O=Math.cos(x)*y,S=Math.sin(x)*y,a=X(U("line"),{stroke:f.color,"stroke-width":(K=f,N=m,E=b,(K.lineWidth||10)*(N?.85:1)/512*E.width),"stroke-linecap":"round","marker-end":z?void 0:"url(#arrowhead-"+f.key+")",opacity:Q(f,m),x1:w[0],y1:w[1],x2:k[0]-O,y2:k[1]-S})}else i=r[W.brush],s=B,l=V(F,c=o),p=c.width/512,u=[3*p,4*p],d=(c.width+c.height)/40,a=X(U("circle"),{stroke:i.color,"stroke-width":u[s?0:1],fill:"none",opacity:Q(i,s),cx:l[0],cy:l[1],r:d-u[1]/2})}return a.setAttribute("cgHash",I),a}(t,e,r,n,i))})}(e,i,r.brushes,o,t,c)}}},{"./util":16}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.colors=["white","black"],r.allKeys=["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50"],r.pos2key=function(e){return r.allKeys[e[0]+5*e[1]-6]},r.key2pos=function(e){return n(parseInt(e))};var n=function(e){return[(e-1)%5+1,(e-1+(5-(e-1)%5))/5]};r.memo=function(e){var t,r=function(){return void 0===t&&(t=e()),t};return r.clear=function(){t=void 0},r},r.timer=function(){var t;return{start:function(){t=Date.now()},cancel:function(){t=void 0},stop:function(){if(!t)return 0;var e=Date.now()-t;return t=void 0,e}}},r.opposite=function(e){return"white"===e?"black":"white"},r.containsX=function(e,t){return void 0!==e&&-1!==e.indexOf(t)},r.distanceSq=function(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},r.samePiece=function(e,t){return e.role===t.role&&e.color===t.color},r.computeIsTrident=function(){return-1<window.navigator.userAgent.indexOf("Trident/")};var a=function(e,t,r,n,o){return 0!==o?[(t?o-.5+e[0]:4.5-(o-.5+e[0]))*r,(t?e[1]-1:10-e[1])*n]:[(t?(e[1]%2!=0?-.5:-1)+e[0]:4.5-((e[1]%2!=0?-.5:-1)+e[0]))*r,(t?e[1]-1:10-e[1])*n]};r.posToTranslateAbs=function(e){var n=e.width/5,o=e.height/10;return function(e,t,r){return a(e,t,n,o,r)}},r.posToTranslateRel=function(e,t,r){return a(e,t,20,10,r)},r.translateAbs=function(e,t){e.style.transform="translate("+t[0]+"px,"+t[1]+"px)"},r.translateRel=function(e,t){e.style.left=t[0]+"%",e.style.top=t[1]+"%"},r.translateAway=function(e){return r.translateAbs(e,[-99999,-99999])},r.eventPosition=function(e){return e.clientX||0===e.clientX?[e.clientX,e.clientY]:e.touches&&e.targetTouches[0]?[e.targetTouches[0].clientX,e.targetTouches[0].clientY]:void 0},r.isRightButton=function(e){return 2===e.buttons||2===e.button},r.createEl=function(e,t){var r=document.createElement(e);return t&&(r.className=t),r},r.raf=(window.requestAnimationFrame||window.setTimeout).bind(window)},{}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./util"),s=e("./svg"),c=[46,47,48,49,50],l=[1,2,3,4,5],u=[5,15,25,35,45],d=[6,16,26,36,46];function p(e,t){var r,n=i.createEl("coords",t);for(var o in e)(r=i.createEl("coord")).textContent=e[o],n.appendChild(r);return n}r.default=function(t,r,e){t.innerHTML="",t.classList.add("cg-board-wrap"),i.colors.forEach(function(e){t.classList.toggle("orientation-"+e,r.orientation===e)}),t.classList.toggle("manipulable",!r.viewOnly);var n,o,a=i.createEl("div","cg-board");return t.appendChild(a),r.drawable.visible&&e&&((n=s.createElement("svg")).appendChild(s.createElement("defs")),t.appendChild(n)),r.coordinates&&("black"===r.orientation?(t.appendChild(p(d,"ranks black")),t.appendChild(p(l,"files black"))):(t.appendChild(p(u,"ranks")),t.appendChild(p(c,"files")))),e&&r.draggable.showGhost&&(o=i.createEl("piece","ghost"),i.translateAway(o),t.appendChild(o)),{board:a,ghost:o,svg:n}}},{"./svg":15,"./util":16}]},{},[11])(11)});